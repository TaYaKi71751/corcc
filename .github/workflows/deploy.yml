name: Build and Deploy
on: 
  workflow_dispatch:
  push:
  schedule:
    - cron:  '0 */3 * * *'
jobs:
  build-and-deploy:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout 🛎️
        uses: actions/checkout@v2.3.1
      - name: Install Docker 🐳
        run: | 
          sudo apt-get update
          sudo ln -fs /usr/share/zoneinfo/Asia/Tokyo /etc/localtime 
          sudo apt-get install tzdata -y
          sudo dpkg-reconfigure --frontend noninteractive tzdata
          sudo apt-get install apt-transport-https ca-certificates curl gnupg-agent software-properties-common
          curl -fsSL https://download.docker.com/linux/ubuntu/gpg | sudo apt-key add -
          sudo add-apt-repository "deb [arch=amd64] https://download.docker.com/linux/ubuntu $(lsb_release -cs) stable"
          sudo apt-get update && sudo apt-get install docker-ce
          sudo usermod -aG docker $USER
      - name: Build Dockerfile 🐳
        run: |
          docker build --force-rm --tag dockerfile:build .
        

      - name: Install and Build 🔧 on Docker 🐳 # This example project is built using npm and outputs the result to the 'build' folder. Replace with the commands required to build your project, or remove this step entirely if your site is pre-built.
        run: |
          docker run -i -v $(pwd):/data dockerfile:build

      - name: Deploy 🚀
        uses: JamesIves/github-pages-deploy-action@4.1.5
        with:
          branch: gh-pages # The branch the action should deploy to.
          folder: build # The folder the action should deploy.