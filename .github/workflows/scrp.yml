on: 
  workflow_dispatch:
  schedule:
    - cron:  '0 */12 * * *'
name: â¬†ï¸ğŸ’‰ğŸ¦ 
jobs:
  node-dep:
    name: ğŸ”§â¬†ï¸âš™ï¸ğŸŸ¢
    runs-on: ubuntu-latest
    steps:
    - name: Setup Node
      uses: actions/setup-node@v2
      with:
        node-version: 'lts/*'
    - name: Checkout ğŸ›ï¸
      uses: actions/checkout@master
    - name: Package-Lock âš™ï¸ğŸŸ¢
      run: npm install --package-lock-only 
    - name: Cache node_modules ğŸ”§âš™ï¸ğŸŸ¢
      uses: actions/cache@v2
      id: cache-modules
      with:
        path: node_modules
        key: ${{ runner.os }}-modules-${{ hashFiles('package-lock.json')}}
    - name: Install Dependencies ğŸ”§ğŸŸ¢
      if: steps.cache-modules.outputs.cache-hit != 'true'
      run: npm install
    - name: Publish package-lock.json â¬†ï¸âš™ï¸ğŸŸ¢
      uses: corcc/publish@master
      env:
        GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }} 
        TASK_NAME: 'ğŸ”§â¬†ï¸âš™ï¸ğŸŸ¢'
        TIMEZONE: 'Asia/Tokyo'
  vaccination:
    name: â¬†ï¸ğŸ’‰
    needs: [node-dep]
    runs-on: ubuntu-latest
    steps:
    - name: Setup Node
      uses: actions/setup-node@v2
      with:
        node-version: 'lts/*'
    - name: Checkout ğŸ›ï¸
      uses: actions/checkout@master
    - name: Cache node_modules ğŸ”§âš™ï¸ğŸŸ¢
      uses: actions/cache@v2
      id: cache-modules
      with:
        path: node_modules
        key: ${{ runner.os }}-modules-${{ hashFiles('package-lock.json')}}
    - name: â¬†ï¸ğŸ’‰
      env:
        USER_AGENT: ${{ secrets.USER_AGENT }}
      run: |
        echo "USER_AGENT=${{ secrets.USER_AGENT }}" >> .env
        npm run vaccination 
    - uses: corcc/publish@master
      env:
        GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }} 
        TASK_NAME: 'â¬†ï¸ğŸ’‰'
        TIMEZONE: 'Asia/Tokyo'
# continued
  case:
    name: â¬†ï¸ğŸ¦ 
    needs: [node-dep]
    runs-on: ubuntu-latest
    steps:
    - name: Setup Node
      uses: actions/setup-node@v2
      with:
        node-version: 'lts/*'
    - name: Checkout ğŸ›ï¸
      uses: actions/checkout@master
    - name: Cache node_modules ğŸ”§âš™ï¸ğŸŸ¢
      uses: actions/cache@v2
      id: cache-modules
      with:
        path: node_modules
        key: ${{ runner.os }}-modules-${{ hashFiles('package-lock.json')}}
    - name: â¬†ï¸ğŸ¦ 
      env:
        USER_AGENT: ${{ secrets.USER_AGENT }}
      run: |
        echo "USER_AGENT=${{ secrets.USER_AGENT }}" >> .env
        npm run case 
    - uses: corcc/publish@master
      env:
        GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }} 
        TASK_NAME: 'â¬†ï¸ğŸ¦ '
        TIMEZONE: 'Asia/Tokyo'
  numberize:
    name: â¬†(0ï¸âƒ£1ï¸âƒ£2ï¸âƒ£3ï¸âƒ£4ï¸âƒ£5ï¸âƒ£6ï¸âƒ£7ï¸âƒ£8ï¸âƒ£9ï¸âƒ£)
    needs: [node-dep,vaccination,case]
    runs-on: ubuntu-latest
    steps:
    - name: Setup Node
      uses: actions/setup-node@v2
      with:
        node-version: 'lts/*'
    - name: Checkout ğŸ›ï¸
      uses: actions/checkout@master
    - name: Pull with --no-rebase â¬†ï¸
      run: git pull --no-rebase
    - name: Cache node_modules ğŸ”§âš™ï¸ğŸŸ¢
      uses: actions/cache@v2
      id: cache-modules
      with:
        path: node_modules
        key: ${{ runner.os }}-modules-${{ hashFiles('package-lock.json')}}
    - name: â¬†(0ï¸âƒ£1ï¸âƒ£2ï¸âƒ£3ï¸âƒ£4ï¸âƒ£5ï¸âƒ£6ï¸âƒ£7ï¸âƒ£8ï¸âƒ£9ï¸âƒ£)
      run: npm run numberize 
    - uses: corcc/publish@master
      env:
        GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }} 
        TASK_NAME: 'â¬†(0ï¸âƒ£1ï¸âƒ£2ï¸âƒ£3ï¸âƒ£4ï¸âƒ£5ï¸âƒ£6ï¸âƒ£7ï¸âƒ£8ï¸âƒ£9ï¸âƒ£)'
        TIMEZONE: 'Asia/Tokyo'
  vc:
    name: â¬†ï¸ğŸ’‰ğŸ¦ 
    needs: [node-dep,vaccination,case,numberize]
    runs-on: ubuntu-latest
    steps:
    - name: Setup Node
      uses: actions/setup-node@v2
      with:
        node-version: 'lts/*'
    - name: Checkout ğŸ›ï¸
      uses: actions/checkout@master
    - name: Pull with --no-rebase â¬†ï¸
      run: git pull --no-rebase
    - name: Cache node_modules ğŸ”§âš™ï¸ğŸŸ¢
      uses: actions/cache@v2
      id: cache-modules
      with:
        path: node_modules
        key: ${{ runner.os }}-modules-${{ hashFiles('package-lock.json')}}
    - name: ğŸ’‰ğŸ¦ 
      run: npm run vc
    - name: â¬†ï¸ğŸ’‰ğŸ¦ 
      uses: corcc/publish@master
      env:
        GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }} 
        TASK_NAME: 'â¬†ï¸ğŸ’‰ğŸ¦ '
        TIMEZONE: 'Asia/Tokyo'
